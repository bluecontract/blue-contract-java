---
name: Task
type:
  blueId: 6F9bjtAd85XgPGvzh7zcZp92tdR4mTcQcMUC8VuPYgZb
subscriptions:
  items:
  - type:
      blueId: FtP9G2GnGiWDGn4jzPp9x4o2Hwat11VyWkbqdJ1DPvNw
    contractInstanceId:
      type:
        blueId: DHmxTkFbXePZHCHCYmQr2dSzcNLcryFVjXVHkdQrrZr8
      value: 100000
workflows:
  items:
  - name: Chat
    steps:
      items:
      - name: AddUserMessageToConversation
        type:
          blueId: 6PsXX3HF74kESc6eg58z8kNwzqD64xQ3PjGPUppzcWg6
        changeset:
          items:
          - val:
              type:
                blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
              value: "${steps.IncomingEntry.message}"
            op:
              type:
                blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
              value: add
            path:
              type:
                blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
              value: /properties/conversation/-
      - name: TriggerAssistantRequest
        type:
          blueId: 3uFwcdCx8Sdw43hGbBL3t9YGRocLbAewHzzxbrKAkUKF
        event:
          type:
            blueId: 5Q1m2vuLKyuSLGK2YAEgqw52kZNWBRx4SC5gHzgzcANf
          task:
            type:
              blueId: 7vshb7SKU42xGbchkfGJbvT6cQSBpAKQJ14iwKZX6nir
            request:
              type:
                blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
              value: "${steps.IncomingEntry.message}"
            response:
              type:
                blueId: 6vXs1bm6wdzhFhmcs1yGtwrcC2xXFRmVyPTgBzu9Vyhy
        condition:
          type:
            blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
          value: "${steps.IncomingEntry.message.generateResponse}"
      - name: ExpectAssistantResponse
        type:
          blueId: 81yruzcExdbod4xZ49qxZpnaWEnDEiGZ7xe5sh13AQ7g
        event:
          type:
            blueId: HWeoWDoYuMGdfzrCJoy58LeH9pFuPQXE9ioHvxVNBcPC
          message:
            type:
              blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
            value: "${steps.TriggerAssistantRequest.event.task}"
          timeline:
            blueId: "${contract('/messaging/participants/Assistant/timeline/blueId')}"
        condition:
          type:
            blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
          value: "${steps.IncomingEntry.message.generateResponse}"
      - name: AddAssistantMessageToConversation
        type:
          blueId: 6PsXX3HF74kESc6eg58z8kNwzqD64xQ3PjGPUppzcWg6
        condition:
          type:
            blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
          value: "${steps.IncomingEntry.message.generateResponse}"
        changeset:
          items:
          - val:
              type:
                blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
              value: "${steps.ExpectAssistantResponse.message.response}"
            op:
              type:
                blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
              value: add
            path:
              type:
                blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
              value: /properties/conversation/-
    trigger:
      name: IncomingEntry
      event:
        type:
          blueId: HWeoWDoYuMGdfzrCJoy58LeH9pFuPQXE9ioHvxVNBcPC
        message:
          type:
            blueId: 9ax84BeyUL3MGsDdrrQEdQGDb21oKpbHSDsWUy45Cded
        timeline:
          blueId: "${contract('/messaging/participants/User/timeline/blueId')}"
  - name: Messages from actualTask
    steps:
      items:
      - name: Apply Changes
        type:
          blueId: 6PsXX3HF74kESc6eg58z8kNwzqD64xQ3PjGPUppzcWg6
        changeset:
          items:
          - val:
              type:
                blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
              value: "${steps.incomingConversationEntry}"
            op:
              type:
                blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
              value: add
            path:
              type:
                blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
              value: /properties/conversation/-
    trigger:
      name: incomingConversationEntry
      event:
        type:
          blueId: 6vXs1bm6wdzhFhmcs1yGtwrcC2xXFRmVyPTgBzu9Vyhy
      contract:
        type:
          blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
        value: "${contract('/properties/actualTask')}"
  - name: contractDef
    steps:
      items:
      - name: init
        type:
          blueId: D7bzHri8CT5j7aZtWVLcTAXkVdrrhe9inGbQopszrtbB
        contract:
          type:
            blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
          value: "${event.message}"
      - type:
          blueId: 6PsXX3HF74kESc6eg58z8kNwzqD64xQ3PjGPUppzcWg6
        changeset:
          items:
          - val:
              type:
                blueId: FtP9G2GnGiWDGn4jzPp9x4o2Hwat11VyWkbqdJ1DPvNw
              contractInstanceId:
                type:
                  blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
                value: "${steps.init.localContract.id}"
            op:
              type:
                blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
              value: add
            path:
              type:
                blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
              value: /subscriptions/-
    trigger:
      event:
        type:
          blueId: HWeoWDoYuMGdfzrCJoy58LeH9pFuPQXE9ioHvxVNBcPC
        message:
          type:
            blueId: 6F9bjtAd85XgPGvzh7zcZp92tdR4mTcQcMUC8VuPYgZb
        timeline:
          blueId: "${contract('/messaging/participants/User/timeline/blueId')}"
  - name: AssistantResponse
    steps:
      items:
      - name: AddUserMessageToConversation
        type:
          blueId: 6PsXX3HF74kESc6eg58z8kNwzqD64xQ3PjGPUppzcWg6
        changeset:
          items:
          - val:
              type:
                blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
              value: "${steps.IncomingEntry.message}"
            op:
              type:
                blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
              value: add
            path:
              type:
                blueId: F92yo19rCcbBoBSpUA5LRxpfDejJDAaP1PRxxbWAraVP
              value: /properties/conversation/-
    trigger:
      name: IncomingEntry
      event:
        type:
          blueId: HWeoWDoYuMGdfzrCJoy58LeH9pFuPQXE9ioHvxVNBcPC
        message:
          type:
            blueId: 6vXs1bm6wdzhFhmcs1yGtwrcC2xXFRmVyPTgBzu9Vyhy
        timeline:
          blueId: "${contract('/messaging/participants/Assistant/timeline/blueId')}"
properties:
  actualTask:
    type:
      blueId: 6gBMYGeWw1Cutbsrzj3c98RH4VrSJNvPsgZ4F4A19i3f
  conversation:
    type:
      blueId: G8wmfjEqugPEEXByMYWJXiEdbLToPRWNQEekNxrxfQWB
messaging:
  participants:
    Assistant:
      description: Someone processing a task
    User:
      description: Someone providing a task
